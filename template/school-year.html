{% extends "main_template.html" %}
{% load static %}
{%load tz%}

{% block title %} School Year {% endblock %}

{% block stylesheet %}
<link rel="stylesheet" href="{% static 'css/school-year.css' %}">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
{% endblock %}

{% block maincontent %}
<div class="container">
  <h2 class="container-title">Accounts</h2>
  <p class="date-value">{% now "F Y" %}</p>
  <!-- Filters -->
  <div class="filters">
    <div class="filter-group">
      <label for="statusFilter">Status:</label>
      <select id="statusFilter" class="status-select" onchange="filterTable()">
        <option value="all">All</option>
        <option value="active">Active</option>
        <option value="archived">Archived</option>
      </select>
    </div>
    <div class="search-container">
      <input type="text" class="search-input" id="searchInput" placeholder="Search accounts..." onkeyup="filterTable()">
      <button class="search-btn" onclick="filterTable()">
        <span class="material-symbols-outlined">search</span>
      </button>
    </div>
  </div>
</div>

<!-- Table -->
<div class="access-table">
  <table id="accessTable">
    <thead>
      <tr>
        <th class="employID">EMPLOYEE ID</th>
        <th class="user_name">NAME</th>
        <th class="user-department">DEPARTMENT</th>
        <th>ACCESS</th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
      <tr data-user-id="{{user.id}}">
        <td class="employID">{{user.employID}}</td>
        <td class="user_name">{{user.full_name}}</td>
        <td class="user-department">{{user.department}}</td>
        <td class="access-actions-cell">
          <div class="access-icons-container">
            {% if user.isActive %}
            <button class="icon-btn active-icon" data-user-id="{{user.id}}" data-user-name="{{user.full_name}}"
              data-is-active="true" title="Active - Click to Archive">
              <span class="material-symbols-outlined">check_circle</span>
            </button>
            <button class="icon-btn pdf-icon disabled" disabled title="No reports available for active users">
              <span class="material-symbols-outlined">picture_as_pdf</span>
            </button>
            {%else%}
            <button class="icon-btn archived-icon" data-user-id="{{user.id}}" data-user-name="{{user.full_name}}"
              data-is-active="false" title="Archived - Click to Activate">
              <span class="material-symbols-outlined">cancel</span>
            </button>
            <button class="icon-btn pdf-icon" data-user-id="{{user.id}}" data-user-name="{{user.full_name}}"
              data-employ-id="{{user.employID}}" data-department="{{user.department}}"
              title="Download Performance Report">
              <span class="material-symbols-outlined">picture_as_pdf</span>
            </button>
            {%endif%}
          </div>
        </td>
      </tr>
      {%endfor%}
    </tbody>
  </table>
</div>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
<script src="{% static 'js/school-year.js' %}"></script>
{% endblock %}